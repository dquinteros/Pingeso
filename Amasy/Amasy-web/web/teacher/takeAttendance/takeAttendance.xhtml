<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  
<ui:composition template="./../../template/teacher.xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                 xmlns="http://www.w3.org/1999/xhtml">

    <ui:define name="content">                                              
        <div id="contentFingerprint" showDetail="true" sticky="true">
            <h:form>  
                <p:growl id="growl" showDetail="true" sticky="true"/> 
                <p:inputText value="#{takeAttendanceMB.fingerprint}" required="true" label="Name" style="display: none"/>  
                <p:commandButton value="Save" actionListener="#{takeAttendanceMB.sendFingerprint(actionEvent)}" update="tableAssistance,growl" style="display: none"/>                  
                <p:dataTable  id="tableAssistance" value="#{takeAttendanceMB.listStudents}" var="student"
                                 emptyMessage="No hay usuarios en el curso" >               
                    <p:column id="rut" headerText="Rut" filterMatchMode="contains" >
                        <h:outputText value="#{student.user.rut}" />
                    </p:column>
                    <p:column id="nombre" headerText="nombre" filterMatchMode="contains" >
                        <h:outputText value="#{student.user.firstName}" />                                
                    </p:column>
                    <p:column id="apellido" headerText="apellido" filterMatchMode="contains" >
                        <h:outputText value="#{student.user.lastName}" />                                
                    </p:column>
                    <p:column id="asistencia" headerText="asistencia" filterMatchMode="contains" >
                        <h:selectBooleanCheckbox disabled="true" value="#{student.present}"/>
                    </p:column>
                </p:dataTable>                  
            </h:form>  
        </div> 
                
        <script type="text/javascript">
            function onLoad() {
                document.loginForm.radioDP.checked = "true";
            }
            var _app = navigator.appName;
            function onErrorHandler() {
                console.log("error");
            }
            function onLoadHandler(){
            }
            function onCaptureHandler() {
            }
            function onEnrollmentFailureHandler() {
            }
            function onFMDHandler( hexFMD ) {
                document.getElementById("contentFingerprint").childNodes[1].childNodes[4].value = hexFMD;                           
                document.getElementById("contentFingerprint").childNodes[1].childNodes[5].click();
            }
            if (_app == 'Netscape') 
            {
                document.write('<object classid="java:UareUApplet.class" type="application/x-java-applet" name="UareUApplet" width="1" height="0" pluginspage="http://java.sun.com/javase/downloads" archive="UareUApplet.jar, dpuareu.jar" onFMDAcquiredScript="onFMDHandler" onEnrollmentFailureScript="onEnrollmentFailureHandler" onImageCapturedScript="onCaptureHandler" onErrorScript="onErrorHandler" bRegistrationMode="false" bDebug="true" bExclusivePriority="true" scriptable="true" mayscript="true" separate_jvm="true" display="none"> </object>');
                document.UareUApplet.SelectFormatANSI();
            }

            else if(_app=='Microsoft Internet Explorer') //we assume IE (use activeX jre plugin)
            {
                document.write( '<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" codebase="http://java.sun.com/update/1.6.0/jinstall-1_6-windows-i586.cab#Version=1,6,0,32" height="0" width="0" name="UareUApplet" display="none"> <param name="type" value="application/x-java-applet;version=1.6" /> <param name="code" value="UareUApplet"/> <param name="scriptable" value="true" /> <param name="archive" value="UareUApplet.jar, dpuareu.jar"/> <param name="onFMDAcquiredScript" value="onFMDHandler" /> <param name="onImageCapturedScript" value="onCaptureHandler" /> <param name="onEnrollmentFailureScript" value="onEnrollmentFailureHandler"/> <param name="bDebug" value="true" /> <param name="bRegistrationMode" value="false" /> <param name="onErrorScript" value="onErrorHandler" /> <param name="bExclusivePriority" value="false"/> <param name="separate_jvm" value="true" /> </object>');
                document.UareUApplet.SelectFormatANSI();
            }
        </script>
    </ui:define>
</ui:composition>
