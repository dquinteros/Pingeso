<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../admin/index.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="content">
        
        
        <h:form id="form">
            <h3>Agregar nuevo estudiante</h3>
            <p:growl for="growl" life="3000"/>
            <h:panelGrid id="grid" columns="3" cellpadding="4">
                <h:outputText value="Nombre: *" />  
                <p:inputText id="firstName" required="true" value="#{addStudentMB.newStudent.firstName}" requiredMessage="Nombre obligatorio">                    
                </p:inputText>
                <p:message for="firstName" display="text" id="asdf"/>                               
                
                <h:outputText value="Apellido: *" />  
                <p:inputText id="lastName" required="true" value="#{addStudentMB.newStudent.lastName}" requiredMessage="Apellido obligatorio"/>  
                <p:message for="lastName" display="text"/>  
                
                <h:outputText value="Celular *" />  
                <p:inputText id="cellPhone" required="true" value="#{addStudentMB.newStudent.cellPhone}" requiredMessage="Celular obligatorio" validatorMessage="El número de teléfono celular solo puede ser numérico">
                    <f:validateRegex for="cellPhone" pattern="[0-9]*"/>
                </p:inputText>  
                <p:message for="cellPhone" display="text"/>  
                
                <h:outputText value="Correo electronico: *" />  
                <p:inputText id="email" required="true" value="#{addStudentMB.newStudent.email}" requiredMessage="Correo obligatorio" validatorMessage="Email no es valido" >
                    <f:validateRegex for="email" pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />                    
                </p:inputText>
                <p:message for="email" display="text"/>
                
                <h:outputText value="Teléfono de casa: *" />  
                <p:inputText id="homePhone" required="true" value="#{addStudentMB.newStudent.homePhone}" requiredMessage="Telefono obligatorio" validatorMessage="El número de teléfono del hogar solo puede ser numérico">
                    <f:validateRegex for="homePhone" pattern="[0-9]*"/>
                </p:inputText>
                <p:message for="homePhone" display="text" />  
                
                <h:outputText value="Rut: *" />  
                <p:inputText id="rut" required="true" value="#{addStudentMB.newStudent.rut}" requiredMessage="Rut obligatorio" validatorMessage="El rut debe tener el siguiente formato: 12345678-X" maxlength="14">
                    <f:validateRegex for="rut" pattern="^0*(\d{1,3}(\.?\d{3})*)\-?([\dkK])$"/> <!--\b\d{1,8}\-[K|k|0-9]-->
                </p:inputText>
                <p:message for="rut" display="text"/>
                
                <h:outputText value="Nombre de usuario: *" />  
                <p:inputText id="userName" required="true" value="#{addStudentMB.newStudent.userName}" requiredMessage="Nombre de usuario obligatorio">
                </p:inputText>
                <p:message for="userName" display="text"/>
                
                <h:outputText value="Huella digital: *" />  
                <p:inputText disabled="true" id="attemptCounter"/>
                <p:message for="fingerprint" display="text"/>
                <p:inputText style="display: none" id="fingerprint" required="true" value="#{addStudentMB.newStudent.fingerprint}" requiredMessage="Huella digital obligatoria"/>                                                                  
            </h:panelGrid>  
            <p:commandButton id="submitButton" value="Crear estudiante" update="form" action="#{addStudentMB.insertNewStudent()}"/>  
        </h:form>  
        
        <script type="text/javascript">  
            var _app = navigator.appName;
            var pressCount = 0;
            //Fired during internal error
            function onErrorHandler(code) {
                console.log("onErrorHandler");
            }

            function onLoadHandler() 
            {
                console.log("onLoadHandler");
            }

            function onDisconnectedHandler() {
                console.log("onDisconnectedHandler");
            }

            function onConnectedHandler() {
                
            }

            function onCaptureHandler() {
                pressCount += 1;
                document.getElementById("form:attemptCounter").value = "presione " + (4 -pressCount) +" veces mas su huella";
            }

            function onEnrollmentFailureHandler() {
                document.getElementById("form:fingerprint").value = null;
                document.getElementById("form:attemptCounter").value = "error: repita la operación";
                pressCount = 0;
            }

            function onFMDHandler( hexFMD ) {
                document.getElementById("form:fingerprint").value = hexFMD;   
                document.getElementById("form:attemptCounter").value = "huella capturada";
                pressCount = 0;        
            }            
    
    
            
            if (_app == 'Netscape') {
                document.write('<object classid="java:UareUApplet.class" type="application/x-java-applet" name="UareUApplet" width="1" height="0" pluginspage="http://java.sun.com/javase/downloads" archive="../../applet/UareUApplet.jar, ../../applet/dpuareu.jar" onFMDAcquiredScript="onFMDHandler" onEnrollmentFailureScript="onEnrollmentFailureHandler" onImageCapturedScript="onCaptureHandler" onDisconnectedScript="onDisconnectedHandler" onConnectedScript="onConnectedHandler" onErrorScript="onErrorHandler" onLoadScript="onLoadHandler" bRegistrationMode="true" bDebug="true" bExclusivePriority="true" scriptable="true" mayscript="true" separate_jvm="true"> </object>');
                document.UareUApplet.SelectFormatANSI();
            }
            else if(_app=='Microsoft Internet Explorer'){
                document.write( '<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" codebase="http://java.sun.com/update/1.6.0/jinstall-1_6-windows-i586.cab#Version=1,6,0,32" height="0" width="0" name="UareUApplet"> <param name="type" value="application/x-java-applet;version=1.6" /> <param name="code" value="UareUApplet"/> <param name="scriptable" value="true" /> <param name="archive" value="../../applet/UareUApplet.jar, ../../applet/dpuareu.jar"/> <param name="onFMDAcquiredScript" value="onFMDHandler" /> <param name="onImageCapturedScript" value="onCaptureHandler" /> <param name="onEnrollmentFailureScript" value="onEnrollmentFailureHandler"/> <param name="onDisconnectedScript" value="onDisconnectedHandler"/> <param name="onConnectedScript" value="onConnectedHandler"/> <param name="onLoadScript" value="onLoadHandler"/> <param name="bDebug" value="true" /> <param name="bRegistrationMode" value="true" /> <param name="onErrorScript" value="onErrorHandler" /> <param name="bExclusivePriority" value="false"/> <param name="separate_jvm" value="true" /> </object>');
                document.UareUApplet.SelectFormatANSI(); 
            }
        </script>
        
        
        
        
    </ui:define>

</ui:composition>
